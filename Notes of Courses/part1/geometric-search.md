# 几何搜索

平衡搜索树在几何方面的应用，处理的键变成几何对象，像点，矩形，甚至更高维的东西。

## 1d range search

先来看一维的情况，一维区间的搜索是后面的基础，处理的对象是在一条线上的点。这是符号表的一个小拓展，多了区间查找（range search） 和区间计数（range count）即希望知道给定区间上有哪些点或是有多少点。

用无序链表来实现的话，插入直接放开头，但是区间查找和区间计数都需要正比于 N 的时间。用有序数组来实现的话，区间计数的时间复杂度是 logN 级别，区间查找是 R+logN 级别（区间内有 R 个点），插入为了维护有序性需要的时间也和 N 成正比。所以说，高效的实现得用 BSTs，插入和区间计数的时间复杂度都是 logN，区间查找的则是 R+logN。

区间计数：

![1d-range-count](https://img2018.cnblogs.com/blog/886021/201901/886021-20190127194219610-1684162525.png)

区间查找：

![1d-range-search](https://img2018.cnblogs.com/blog/886021/201901/886021-20190127194252626-489357777.png)

## line segment intersection

接着我们到二维，有很多水平或垂直的线段，现在希望找到所有交点。

![line-segment-intersection](https://img2018.cnblogs.com/blog/886021/201901/886021-20190127194347651-1192355983.png)

遍历检查所有可能组合会是平方级别的复杂度，显然是不可接受的，其实我们可以把问题转成上面一维的情况。

![2d-sweep](https://img2018.cnblogs.com/blog/886021/201901/886021-20190127194419668-696125613.png)

方便起见，这边的线段没有重合啥七七八八的情况。假想有一条垂直的线，从左扫到右，碰到水平线段的左端点就把该线段的 y 值放入 BST，碰到水平线段的右端点就把该线段的 y 值从 BST 中移除，碰到垂直线段就以该线段的上下端点为区间在 BST 中做区间计数。像上面的例图，点 2 已经从 BST 中移除了，点 4 是第一个垂直线段，区间查找发现有个点 1，也就发现了第一个交点。

## kd trees

## interval search trees

## retangle intersection